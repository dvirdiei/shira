# הנוסע המתמיד - מערכת מפות ביקורים ירושלים

## מבנה הפרויקט המודולרי

### תיקיות ראשיות
```
אתר/
├── database/              # קבצי נתונים
│   ├── found_addresses.csv      # כתובות עם קואורדינטות
│   ├── not_found_addresses.csv  # כתובות ללא קואורדינטות
│   ├── future_use.csv           # כתובות עתידיות
│   └── deleted_addresses.csv    # כתובות שנמחקו (עם תאריך)
├── ToHtml/               # קבצי JavaScript מודולריים
│   ├── data-loader.js           # טעינת נתונים מהשרת
│   ├── map-markers.js           # מארקרים ותצוגת מפה
│   ├── user-actions.js          # פעולות משתמש (ביקורים, מחיקות)
│   └── found.js                 # קובץ ראשי לטעינת המודולים
├── PYTHON/               # לוגיקת השרת
│   ├── api_handlers.py          # פונקציות API
│   ├── routes.py                # נתבי Flask
│   └── __init__.py
├── static/               # קבצים סטטיים
│   ├── style.css                # עיצוב
│   └── script.js                # התחלת המפה
├── templates/            # תבניות HTML
│   └── index.html
├── ToMap/               # כלי גיאוקודינג
│   └── adreesToMap_simple.py
└── main.py              # שרת Flask ראשי
```

## פיצ'רים חדשים

### ✅ מבנה מודולרי
הקוד חולק ל-3 קבצי JavaScript נפרדים:
- **data-loader.js**: טעינת נתונים, יצירת סיכומים
- **map-markers.js**: יצירת מארקרים, פופאפים ותצוגת מפה
- **user-actions.js**: פעולות משתמש - ביקורים, ניווט, מחיקות

### 🗑️ מחיקת נקודות
- כפתור מחיקה בכל פופאפ
- אישור מחיקה עם הודעה ברורה
- העברה אוטומטית לקובץ `deleted_addresses.csv`
- שמירת תאריך המחיקה

### 📱 הודעות חכמות למשתמש
- הודעות עדכון יפות במקום alert
- אנימציות חלקות
- סוגי הודעות: הצלחה, שגיאה, אזהרה

### 🎯 ביקורים
- סימון/ביטול ביקורים
- עדכון מיידי במפה
- שמירה בקובצי CSV

### 🧭 ניווט
- פתיחה ב-Google Maps
- פתיחה ב-Waze
- קואורדינטות מדויקות

## הפעלה

1. **התקנת תלויות:**
   ```bash
   pip install flask
   ```

2. **הרצת השרת:**
   ```bash
   python main.py
   ```

3. **פתיחת הדפדפן:**
   ```
   http://localhost:5000
   ```

## API Endpoints

### GET /api/all-addresses
מחזיר את כל הכתובות עם קואורדינטות

### GET /api/missing-coordinates  
מחזיר כתובות ללא קואורדינטות

### POST /api/toggle-visited
עדכון סטטוס ביקור
```json
{
    "address": "שם הכתובת",
    "action": "mark" // או "unmark"
}
```

### POST /api/delete-address
מחיקת כתובת
```json
{
    "address": "שם הכתובת"
}
```

## קבצי נתונים

### found_addresses.csv
```csv
כתובת,קו רוחב,קו אורך,שכונה,ביקרנו
הרב ריינס ירושלים,31.7903429,35.1940735,Givat Shaul,לא
```

### deleted_addresses.csv
```csv
כתובת,שכונה,קו רוחב,קו אורך,ביקרנו,תאריך_מחיקה
כתובת שנמחקה,שכונה,31.123,35.456,כן,2025-07-03 23:45:12
```

## פיתוח

### הוספת פיצ'רים חדשים
1. הוסף את הלוגיקה ב-`PYTHON/api_handlers.py`
2. הוסף נתב ב-`PYTHON/routes.py`
3. הוסף פונקציונליות ב-JavaScript המתאים
4. עדכן עיצוב ב-`static/style.css`

### דיבוג
- הפעל את Flask במצב debug
- בדוק את הקונסול בדפדפן
- בדוק את logs של השרת

## יתרונות המבנה החדש

1. **קריאות**: כל חלק בקובץ נפרד
2. **תחזוקה**: קל לעדכן חלק ספציפי
3. **ביצועים**: טעינה מודולרית
4. **הרחבה**: קל להוסיף פיצ'רים חדשים
5. **בדיקות**: כל מודול ניתן לבדיקה נפרדת

---

**פותח על ידי**: GitHub Copilot  
**גרסה**: 3.0 - Modular Architecture  
**עדכון אחרון**: יולי 2025
